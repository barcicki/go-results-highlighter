!function(e){if("object"==typeof exports)module.exports=e();else if("function"==typeof define&&define.amd)define(e);else{var t;"undefined"!=typeof window?t=window:"undefined"!=typeof global?t=global:"undefined"!=typeof self&&(t=self),t.GoResultsHighlighter=e()}}(function(){return function e(t,r,n){function s(o,l){if(!r[o]){if(!t[o]){var a="function"==typeof require&&require;if(!l&&a)return a(o,!0);if(i)return i(o,!0);throw new Error("Cannot find module '"+o+"'")}var u=r[o]={exports:{}};t[o][0].call(u.exports,function(e){var r=t[o][1][e];return s(r?r:e)},u,u.exports,e,t,r,n)}return r[o].exports}for(var i="function"==typeof require&&require,o=0;o<n.length;o++)s(n[o]);return s}({1:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function s(){var e=(0,i.asArray)(document.querySelectorAll("[go-results],[data-go-results]"));e.forEach(function(e){e.goResultsHighlighter=new o["default"](e)})}Object.defineProperty(r,"__esModule",{value:!0});var i=e("./plugin"),o=n(i);"complete"===document.readyState?s():document.addEventListener("DOMContentLoaded",s,!1),r["default"]=o["default"],t.exports=r["default"]},{"./plugin":2}],2:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e){return Array.prototype.slice.call(e)}function i(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;t>n;n++)r[n-1]=arguments[n];var s=r.filter(function(e){return"object"==typeof e}).reverse(),i=s.length,o={};e:for(var l in e){for(var a=0;i>a;a++)if(s[a].hasOwnProperty(l)){o[l]=s[a][l];continue e}o[l]=e[l]}return o}function o(e){var t=[];for(var r in e)e.hasOwnProperty(r)&&t.push({cls:r,regexp:new RegExp(e[r])});return t}function l(e){var t={};return v.forEach(function(r){var n=e.getAttribute(d+r);n||(n=e.getAttribute("data-"+d+r)),n&&(t[r]=n)}),t}function a(e,t){e.setAttribute(h,t)}function u(e,t){var r=s(e.querySelectorAll(t.rowTags)),n=o(t.results),i=n.length,l={},u=void 0,c=void 0;return r.forEach(function(e,r){if(!(r<t.row)){var o=s(e.querySelectorAll(t.cellTags)),f=-1;if(!o.length||!o[t.column])return a(e,f);var h=parseInt(o[t.column].textContent,10);if(c)f=c+1;else{if(isNaN(h))return a(e,f);f=h||1}h?u>=h&&(h=u):h=u?u:1;var p={place:h,row:e,games:{},opponents:[]};return o.forEach(function(e){for(var t=0;i>t;t++){var r=e.textContent.match(n[t].regexp);if(r){var s=Number(r[1]);e.setAttribute(g,s),p.games[s]={cell:e,cls:n[t].cls},p.opponents.push(s)}}}),p.opponents.sort(function(e,t){return e>t?1:-1}),l[f]=p,u=h,c=f,a(e,f)}}),l}Object.defineProperty(r,"__esModule",{value:!0});var c=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();r.asArray=s,r.defaults=i,r.readDomSettings=l,r.mapRowsToPlayers=u;var f={prefixCls:"go-results-",showingDetailsCls:"showing-details",tableCls:"table",gameCls:"game",currentCls:"current",overlayCls:"overlay",results:{won:"([0-9]+)\\+",lost:"([0-9]+)\\-",jigo:"([0-9]+)=",unresolved:"([0-9]+)\\?"},row:0,column:0,rowTags:"tr",cellTags:"td,th",hovering:!0,clicking:!0};r.DEFAULT_SETTINGS=f;var h="data-go-place",g="data-go-opponent-place",p=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),d="go-results-",v=["column","row"],m=function(){function e(t,r){n(this,e),this.element=t,this.element.classList&&(this.settings=i(f,l(t),r),this.createPlayersMap(),this.bindEvents(),this.element.classList.add(this.settings.prefixCls+this.settings.tableCls),this.showingDetails=!1)}return c(e,[{key:"createPlayersMap",value:function(){this.map=u(this.element,this.settings),this.players=[];for(var e in this.map)this.map.hasOwnProperty(e)&&this.players.push(this.map[e])}},{key:"selectPlayer",value:function(e,t){function r(e,t){var r=this,n=t?"add":"remove";e.row.classList[n](i),e.opponents.forEach(function(t){var s=r.map[t];s.row.classList[n](r.settings.prefixCls+e.games[t].cls)})}var n=this,i=this.settings.prefixCls+this.settings.currentCls,o=this.settings.prefixCls+this.settings.gameCls,l=this.map[e],a=s(this.element.querySelectorAll("."+o)),u=this.element.querySelector("."+i),c=u?u.getAttribute(h):null,f=c?this.map[c]:null;a.forEach(function(e){e.classList.remove(o)}),f&&f!==l&&r.call(this,f,!1),l&&l!==f&&r.call(this,l,!0),this.showingDetails?l.opponents.forEach(function(t){n.map[t].games[e].cell.classList.add(o)}):l&&t&&(l.games[t].cell.classList.add(o),this.map[t].games[e].cell.classList.add(o))}},{key:"restoreFullResults",value:function(){this.players.filter(function(e){return e.row.properNextSibling}).reverse().forEach(function(e){e.row.parentNode.insertBefore(e.row,e.row.properNextSibling),e.row.properNextSibling=null}),this.element.classList.remove(this.settings.prefixCls+this.settings.showingDetailsCls),this.showingDetails=!1}},{key:"showDetails",value:function(e){var t=this,r=this.map[e];if(r){var n=r.row.parentNode,s=r.row.nextSibling;r.opponents.forEach(function(i){var o=t.map[i];o.row.properNextSibling=o.row.nextSibling,e>i?n.insertBefore(o.row,r.row):(n.insertBefore(o.row,s),s=o.row.nextSibling)}),(!p||this.players.length<100)&&this.element.classList.add(this.settings.prefixCls+this.settings.showingDetailsCls),this.showingDetails=!0,this.selectPlayer(e)}}},{key:"bindEvents",value:function(){var e=this;this.element.addEventListener("click",function(t){if(e.settings.clicking!==!1){if(e.showingDetails)return void e.restoreFullResults();for(var r=t.target,n=null;r&&r!==document;){var s=r.getAttribute(h);if(s){n=s;break}r=r.parentNode}n&&e.showDetails(n)}}),this.element.addEventListener("mouseover",function(t){if(e.settings.hovering!==!1&&!e.showingDetails){for(var r=t.target,n=null,s=null;r&&r!==document;){var i=r.getAttribute(g),o=r.getAttribute(h);if(i&&(n=i),o){s=o;break}r=r.parentNode}s&&e.selectPlayer(s,n)}},!1),this.element.addEventListener("mouseout",function(t){if(e.settings.hovering!==!1&&!e.showingDetails){for(var r=t.relatedTarget;r&&r!==document&&r!==e.element;)r=r.parentNode;r!==e.element&&e.selectPlayer(-1)}},!1)}}]),e}();r["default"]=m,m.DEFAULT_SETTINGS=f},{}]},{},[1])(1)});