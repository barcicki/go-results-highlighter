!function(e){if("object"==typeof exports)module.exports=e();else if("function"==typeof define&&define.amd)define(e);else{var t;"undefined"!=typeof window?t=window:"undefined"!=typeof global?t=global:"undefined"!=typeof self&&(t=self),t.GoResultsHighlighter=e()}}(function(){return function e(t,n,r){function i(o,l){if(!n[o]){if(!t[o]){var a="function"==typeof require&&require;if(!l&&a)return a(o,!0);if(s)return s(o,!0);throw new Error("Cannot find module '"+o+"'")}var u=n[o]={exports:{}};t[o][0].call(u.exports,function(e){var n=t[o][1][e];return i(n?n:e)},u,u.exports,e,t,n,r)}return n[o].exports}for(var s="function"==typeof require&&require,o=0;o<r.length;o++)i(r[o]);return i}({1:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(){(0,a.asArray)(document.querySelectorAll("["+l.DOM_ATTRIBUTES.RESULT_TABLE+"]")).forEach(function(e){return new o["default"](e)})}Object.defineProperty(n,"__esModule",{value:!0});var s=e("./lib/highlighter"),o=r(s),l=e("./lib/settings"),a=e("./lib/utils");"complete"===document.readyState?i():document.addEventListener("DOMContentLoaded",i,!1),"undefined"!=typeof jQuery&&(jQuery.fn.goResultsHighlighter=function(e){return this.each(function(t,n){var r=new o["default"](n,e);$(r.element).data("GoResultsHighlighter",r)}),this}),n["default"]=o["default"]},{"./lib/highlighter":2,"./lib/settings":5,"./lib/utils":6}],2:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e){return e&&"undefined"!=typeof Symbol&&e.constructor===Symbol?"symbol":typeof e}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e){e.filter(function(e){return e.row.properNextSibling}).reverse().forEach(function(e){-1===e.row.properNextSibling?e.row.parentNode.appendChild(e.row):e.row.parentNode.insertBefore(e.row,e.row.properNextSibling),e.row.properNextSibling=null})}function l(e,t){var n=e.row.parentNode,r=e.row.nextElementSibling;t.forEach(function(t){t.row.properNextSibling=t.row.nextElementSibling||-1,t.tournamentPlace<e.tournamentPlace?n.insertBefore(t.row,e.row):(n.insertBefore(t.row,r),r=t.row.nextElementSibling)})}var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();Object.defineProperty(n,"__esModule",{value:!0});var u=e("./settings"),c=e("./parser"),f=r(c),g=e("./raw2table"),h=r(g),T=e("./utils"),d=function(){function e(t,n){if(s(this,e),this.settings=(0,T.defaults)(u.DEFAULT_SETTINGS,(0,u.readTableSettingsFromDOM)(t),n),t instanceof HTMLPreElement){var r=(0,h["default"])(t.innerHTML,n),i=t.parentNode;i.insertBefore(r,t),i.removeChild(t),this.element=r}else this.element=t;this.element.classList&&(this.createPlayersMap(),this.bindEvents(),this.element.classList.add(this.settings.prefixCls+this.settings.tableCls),this.element.goResultsHighlighter=this,this.current=null,this.isShowingDetails=!1,this.isHighlighting=!1)}return a(e,[{key:"createPlayersMap",value:function(){this.map=(0,f["default"])(this.element,this.settings),this.players=[];for(var e in this.map)this.map.hasOwnProperty(e)&&this.players.push(this.map[e])}},{key:"highlight",value:function(e){var t=this,n=arguments.length<=1||void 0===arguments[1]?!1:arguments[1],r=void 0,s=void 0;e&&"object"===("undefined"==typeof e?"undefined":i(e))?(r=e.player,n=e.compact===!0,s=e.opponent):r=e;var a=this.map[r],c=(0,u.toPrefixedClasses)(this.settings);this.isShowingDetails&&o(this.players),a&&n?(l(a,a.opponents.map(function(e){return t.map[e]})),this.element.classList.add(c.showingDetailsCls),this.isShowingDetails=!0):(this.element.classList.remove(c.showingDetailsCls),this.isShowingDetails=!1);var f=(0,T.asArray)(this.element.querySelectorAll("."+c.gameCls)),g=this.element.querySelector("."+c.currentCls),h=g?g.getAttribute(u.DOM_ATTRIBUTES.PLAYER_PLACEMENT):null,d=h?this.map[h]:null,p=function(e,n){var r=n?"add":"remove";e.row.classList[r](c.currentCls),e.opponents.forEach(function(n){var i=t.map[n];i.row.classList[r](t.settings.prefixCls+e.games[n].cls)})};if(f.forEach(function(e){e.classList.remove(c.gameCls)}),d&&d!==a&&p(d,!1),a&&a!==d&&p(a,!0),a){if(s&&this.map[s]){var E=a.games[s],m=this.map[s];E&&m&&(E.cell.classList.add(c.gameCls),m.games[r].cell.classList.add(c.gameCls))}else this.isShowingDetails&&a.opponents.forEach(function(e){t.map[e].games[r].cell.classList.add(c.gameCls)});this.current=r,this.isHighlighting=!0}else this.current=null,this.isHighlighting=!1}},{key:"bindEvents",value:function(){function e(e){for(var t={player:null,opponent:null,target:null};e&&e!==document;){var n=e.getAttribute(u.DOM_ATTRIBUTES.OPPONENT_PLACEMENT),r=e.getAttribute(u.DOM_ATTRIBUTES.PLAYER_PLACEMENT);if(n&&(t.opponent=Number(n)),r){t.player=Number(r);break}e=e.parentNode}return t.target=e,t}var t=this;this.element.addEventListener("touchend",function(n){if(t.settings.clicking!==!1||t.settings.hovering!==!1){var r=e(n.target),i=r.target,s=r.player,o=r.opponent;if(s){var l=!1,a=void 0;if(t.current===s?(t.settings.clicking&&t.settings.hovering||(s=null),l=!t.isShowingDetails):(t.isShowingDetails||!t.settings.hovering)&&(l=!0),l&&(a=i.getBoundingClientRect().top),t.highlight({player:s,opponent:o,compact:l}),a){var u=i.getBoundingClientRect().top-a;Math.abs(u)>10&&window.scrollBy(0,u)}n.preventDefault()}}}),this.element.addEventListener("click",function(e){if(t.settings.clicking!==!1){for(var n=e.target,r=null;n&&n!==document;){var i=n.getAttribute(u.DOM_ATTRIBUTES.PLAYER_PLACEMENT);if(i){r=Number(i);break}n=n.parentNode}if(r){var s=void 0;if(t.isShowingDetails?n.properNextSibling?(s=n.getBoundingClientRect().top,t.highlight(r,!0)):(s=n.getBoundingClientRect().top,t.settings.hovering?t.highlight(r):t.highlight(-1)):t.highlight(r,!0),s){var o=n.getBoundingClientRect().top-s;Math.abs(o)>10&&window.scrollBy(0,o)}}}}),this.element.addEventListener("mouseover",function(e){if(t.settings.hovering!==!1&&!t.isShowingDetails){for(var n=e.target,r=null,i=null;n&&n!==document;){var s=n.getAttribute(u.DOM_ATTRIBUTES.OPPONENT_PLACEMENT),o=n.getAttribute(u.DOM_ATTRIBUTES.PLAYER_PLACEMENT);if(s&&(r=Number(s)),o){i=Number(o);break}n=n.parentNode}i&&t.highlight({player:i,opponent:r})}},!1),this.element.addEventListener("mouseout",function(e){if(t.settings.hovering!==!1&&!t.isShowingDetails){for(var n=e.relatedTarget;n&&n!==document&&n!==t.element;)n=n.parentNode;n!==t.element&&t.highlight(-1)}},!1)}}]),e}();n["default"]=d,d.DEFAULT_SETTINGS=u.DEFAULT_SETTINGS},{"./parser":3,"./raw2table":4,"./settings":5,"./utils":6}],3:[function(e,t,n){"use strict";function r(e,t){e.setAttribute(o.DOM_ATTRIBUTES.PLAYER_PLACEMENT,t)}function i(e,t){function n(e,t){"string"==typeof i.roundsColumns&&(t=i.roundsColumns.split(",").map(function(e){return t[Number(e)]})),t.forEach(function(t){var n=void 0,r=void 0;if(t.hasAttribute(o.DOM_ATTRIBUTES.GAME_RESULT)&&t.hasAttribute(o.DOM_ATTRIBUTES.OPPONENT_PLACEMENT))n=Number(t.getAttribute(o.DOM_ATTRIBUTES.OPPONENT_PLACEMENT)),r=t.getAttribute(o.DOM_ATTRIBUTES.GAME_RESULT);else{for(var i=0;u>i;i++){var s=t.textContent.match(a[i].regexp);s&&(n=Number(s[1]),r=a[i].cls,t.setAttribute(o.DOM_ATTRIBUTES.OPPONENT_PLACEMENT,n),t.setAttribute(o.DOM_ATTRIBUTES.GAME_RESULT,a[i].cls))}if(!n)return}e.games[n]={cell:t,cls:r},e.opponents.push(n)})}var i=(0,s.defaults)(o.DEFAULT_SETTINGS,t),l=(0,s.asArray)(e.querySelectorAll(i.rowTags)),a=(0,o.toResultsWithRegExp)(i.results),u=a.length,c={},f=void 0,g=void 0;return l.forEach(function(e,t){if(!(t<i.startingRow)){var l=(0,s.asArray)(e.querySelectorAll(i.cellTags)),a=-1;if(!l.length||!l[i.placeColumn])return void r(e,a);var u=parseInt(l[i.placeColumn].textContent,10),h={tournamentPlace:-1,row:e,games:{},opponents:[]};if(e.hasAttribute(o.DOM_ATTRIBUTES.PLAYER_PLACEMENT))a=Number(e.getAttribute(o.DOM_ATTRIBUTES.PLAYER_PLACEMENT));else{if(g)a=g+1;else{if(isNaN(u))return void r(e,a);a=u||1}u?f>=u&&(u=f):u=f?f:1,r(e,a)}-1!=a&&(n(h,l),h.tournamentPlace=u,h.opponents.sort(function(e,t){return e>t?1:-1}),c[a]=h,f=u,g=a)}}),c}Object.defineProperty(n,"__esModule",{value:!0}),n["default"]=i;var s=e("./utils"),o=e("./settings")},{"./settings":5,"./utils":6}],4:[function(e,t,n){"use strict";function r(e,t){var n=document.createElement("table");if(!e)return n;var r=(0,s.defaults)(i.DEFAULT_SETTINGS,t),o=e.split(/\r\n|\n/);if(o.length<=2&&!o[0]&&!o[1])return n;var l=(0,i.toResultsWithRegExp)(r.results),a=l.length,u=o.map(function(e){return e.replace(/([0-9]+)\s(dan|kyu)/i,"$1_$2").split(new RegExp(r.cellSeparator)).filter(function(e){return e.length>0})}).filter(function(e){return e.length>0&&0!==e[0].indexOf(";")}),c=u.reduce(function(e,t){return Math.max(e,t.length)},0),f=r.joinNames?-1:0,g=r.placeColumn+1,h=null;"string"==typeof r.roundsColumns&&(h=r.roundsColumns.split(",").map(Number));var T=void 0;return u.forEach(function(e,t){var s=document.createElement("tr"),o=e.length;if(o){if(t<r.startingRow||c+f>o){var u=document.createElement("td");u.setAttribute("colspan",c+f),u.textContent=e.join(" "),s.setAttribute(i.DOM_ATTRIBUTES.PLAYER_PLACEMENT,-1),s.appendChild(u)}else{var d=parseInt(e[r.placeColumn],10);isNaN(d)&&!T?e.forEach(function(e){var t=document.createElement("td");t.textContent=e,s.setAttribute(i.DOM_ATTRIBUTES.PLAYER_PLACEMENT,-1),s.appendChild(t)}):!function(){s.setAttribute(i.DOM_ATTRIBUTES.PLAYER_PLACEMENT,T||d);var t=[];r.joinNames&&e.splice(g,2,e[g]+"  "+e[g+1]),e.forEach(function(e,n){var r=document.createElement("td");if(r.textContent=e.replace(/_/," "),!h||h.indexOf(n)>=0)for(var o=0;a>o;o++){var u=e.match(l[o].regexp);if(u){var c=u[1];t.push(c),r.setAttribute(i.DOM_ATTRIBUTES.OPPONENT_PLACEMENT,c),r.setAttribute(i.DOM_ATTRIBUTES.GAME_RESULT,l[o].cls)}}s.appendChild(r)}),t.length&&s.setAttribute(i.DOM_ATTRIBUTES.OPPONENTS,t.join(",")),T?T+=1:T=2}()}n.appendChild(s)}}),n.setAttribute(i.DOM_ATTRIBUTES.RESULT_TABLE,""),n}Object.defineProperty(n,"__esModule",{value:!0}),n["default"]=r;var i=e("./settings"),s=e("./utils")},{"./settings":5,"./utils":6}],5:[function(e,t,n){"use strict";function r(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push({cls:n,regexp:new RegExp(e[n])});return t}function i(e){var t={};return o.forEach(function(n){t[n]=e.prefixCls+e[n]}),t}function s(e){var t={};return e.hasAttribute(l.SETTING_PLACE_COLUMN)&&(t.placeColumn=Number(e.getAttribute(l.SETTING_PLACE_COLUMN))),e.hasAttribute(l.SETTING_STARTING_ROW)&&(t.startingRow=Number(e.getAttribute(l.SETTING_STARTING_ROW))),e.hasAttribute(l.SETTING_ROUNDS_COLUMNS)&&(t.roundsColumns=e.getAttribute(l.SETTING_ROUNDS_COLUMNS)),e.hasAttribute(l.SETTING_CLICKING)&&(t.clicking="false"!==e.getAttribute(l.SETTING_CLICKING)),e.hasAttribute(l.SETTING_HOVERING)&&(t.hovering="false"!==e.getAttribute(l.SETTING_HOVERING)),t}Object.defineProperty(n,"__esModule",{value:!0}),n.toResultsWithRegExp=r,n.toPrefixedClasses=i,n.readTableSettingsFromDOM=s;var o=(n.DEFAULT_SETTINGS={prefixCls:"go-results-",showingDetailsCls:"showing-details",tableCls:"table",gameCls:"game",currentCls:"current",results:{won:"([0-9]+)\\+",lost:"([0-9]+)\\-",jigo:"([0-9]+)=",unresolved:"([0-9]+)\\?"},startingRow:0,placeColumn:0,roundsColumns:null,rowTags:"tr",cellTags:"td,th",cellSeparator:"[	 ]+",joinNames:!0,hovering:!0,clicking:!0},["showingDetailsCls","tableCls","gameCls","currentCls"]),l=n.DOM_ATTRIBUTES={RESULT_TABLE:"data-go-results",SETTING_STARTING_ROW:"data-go-starting-row",SETTING_PLACE_COLUMN:"data-go-place-col",SETTING_ROUNDS_COLUMNS:"data-go-rounds-cols",SETTING_CLICKING:"data-go-clicking",SETTING_HOVERING:"data-go-hovering",PLAYER_PLACEMENT:"data-go-place",OPPONENT_PLACEMENT:"data-go-opponent",OPPONENTS:"data-go-opponents",GAME_RESULT:"data-go-result"}},{}],6:[function(e,t,n){"use strict";function r(e){return e&&"undefined"!=typeof Symbol&&e.constructor===Symbol?"symbol":typeof e}function i(e){return Array.prototype.slice.call(e)}function s(e){for(var t=arguments.length,n=Array(t>1?t-1:0),i=1;t>i;i++)n[i-1]=arguments[i];var s=n.filter(function(e){return"object"===("undefined"==typeof e?"undefined":r(e))}).reverse(),o=s.length,l={};e:for(var a in e){for(var u=0;o>u;u++)if(s[u].hasOwnProperty(a)){l[a]=s[u][a];continue e}l[a]=e[a]}return l}function o(){for(var e={},t=arguments.length,n=Array(t),r=0;t>r;r++)n[r]=arguments[r];return n.forEach(function(t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])}),e}Object.defineProperty(n,"__esModule",{value:!0}),n.asArray=i,n.defaults=s,n.combine=o},{}]},{},[1])(1)});