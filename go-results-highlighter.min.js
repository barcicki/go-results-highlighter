!function(e){if("object"==typeof exports)module.exports=e();else if("function"==typeof define&&define.amd)define(e);else{var t;"undefined"!=typeof window?t=window:"undefined"!=typeof global?t=global:"undefined"!=typeof self&&(t=self),t.GoResultsHighlighter=e()}}(function(){return function e(t,r,n){function i(o,a){if(!r[o]){if(!t[o]){var l="function"==typeof require&&require;if(!a&&l)return l(o,!0);if(s)return s(o,!0);throw new Error("Cannot find module '"+o+"'")}var u=r[o]={exports:{}};t[o][0].call(u.exports,function(e){var r=t[o][1][e];return i(r?r:e)},u,u.exports,e,t,r,n)}return r[o].exports}for(var s="function"==typeof require&&require,o=0;o<n.length;o++)i(n[o]);return i}({1:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function i(){(0,l.asArray)(document.querySelectorAll("["+a.DOM_ATTRIBUTES.RESULT_TABLE+"]")).forEach(function(e){return new o["default"](e)})}Object.defineProperty(r,"__esModule",{value:!0});var s=e("./lib/highlighter"),o=n(s),a=e("./lib/settings"),l=e("./lib/utils");"complete"===document.readyState?i():document.addEventListener("DOMContentLoaded",i,!1),"undefined"!=typeof jQuery&&(jQuery.fn.goResultsHighlighter=function(e){return this.each(function(t,r){var n=new o["default"](r,e);$(n.element).data("GoResultsHighlighter",n)}),this}),r["default"]=o["default"],t.exports=r["default"]},{"./lib/highlighter":2,"./lib/settings":5,"./lib/utils":6}],2:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=e("./settings"),a=e("./parser"),l=n(a),u=e("./raw2table"),c=n(u),f=e("./utils"),T=function(){function e(t,r){if(i(this,e),this.settings=(0,f.defaults)(o.DEFAULT_SETTINGS,(0,o.readTableSettingsFromDOM)(t),r),t instanceof HTMLPreElement){var n=(0,c["default"])(t.innerHTML,r),s=t.parentNode;s.insertBefore(n,t),s.removeChild(t),this.element=n}else this.element=t;this.element.classList&&(this.createPlayersMap(),this.bindEvents(),this.element.classList.add(this.settings.prefixCls+this.settings.tableCls),this.element.goResultsHighlighter=this,this.showingDetails=!1)}return s(e,[{key:"createPlayersMap",value:function(){this.map=(0,l["default"])(this.element,this.settings),this.players=[];for(var e in this.map)this.map.hasOwnProperty(e)&&this.players.push(this.map[e])}},{key:"selectPlayer",value:function(e,t){function r(e,t){var r=this,n=t?"add":"remove";e.row.classList[n](i),e.opponents.forEach(function(t){var i=r.map[t];i.row.classList[n](r.settings.prefixCls+e.games[t].cls)})}var n=this,i=this.settings.prefixCls+this.settings.currentCls,s=this.settings.prefixCls+this.settings.gameCls,a=this.map[e],l=(0,f.asArray)(this.element.querySelectorAll("."+s)),u=this.element.querySelector("."+i),c=u?u.getAttribute(o.DOM_ATTRIBUTES.PLAYER_PLACEMENT):null,T=c?this.map[c]:null;l.forEach(function(e){e.classList.remove(s)}),T&&T!==a&&r.call(this,T,!1),a&&a!==T&&r.call(this,a,!0),this.showingDetails?a.opponents.forEach(function(t){n.map[t].games[e].cell.classList.add(s)}):a&&t&&(a.games[t].cell.classList.add(s),this.map[t].games[e].cell.classList.add(s))}},{key:"showDetails",value:function(e){var t=this,r=this.map[e];if(this.showingDetails&&(this.players.filter(function(e){return e.row.properNextSibling}).reverse().forEach(function(e){-1===e.row.properNextSibling?e.row.parentNode.appendChild(e.row):e.row.parentNode.insertBefore(e.row,e.row.properNextSibling),e.row.properNextSibling=null}),this.element.classList.remove(this.settings.prefixCls+this.settings.showingDetailsCls)),!r)return this.showingDetails=!1,void this.selectPlayer(-1);var n=r.row.parentNode,i=r.row.nextElementSibling;r.opponents.forEach(function(s){var o=t.map[s];o.row.properNextSibling=o.row.nextElementSibling||-1,e>s?n.insertBefore(o.row,r.row):(n.insertBefore(o.row,i),i=o.row.nextElementSibling)}),this.element.classList.add(this.settings.prefixCls+this.settings.showingDetailsCls),this.showingDetails=!0,this.selectPlayer(e)}},{key:"bindEvents",value:function(){var e=this;this.element.addEventListener("click",function(t){if(e.settings.clicking!==!1){for(var r=t.target,n=null;r&&r!==document;){var i=r.getAttribute(o.DOM_ATTRIBUTES.PLAYER_PLACEMENT);if(i){n=Number(i);break}r=r.parentNode}if(n){var s=void 0;if(e.showingDetails?r.properNextSibling?(s=r.getBoundingClientRect().top,e.showDetails(n)):(s=r.getBoundingClientRect().top,e.showDetails(-1),e.settings.hovering&&e.selectPlayer(n)):e.showDetails(n),s){var a=r.getBoundingClientRect().top-s;Math.abs(a)>10&&window.scrollBy(0,a)}}}}),this.element.addEventListener("mouseover",function(t){if(e.settings.hovering!==!1&&!e.showingDetails){for(var r=t.target,n=null,i=null;r&&r!==document;){var s=r.getAttribute(o.DOM_ATTRIBUTES.OPPONENT_PLACEMENT),a=r.getAttribute(o.DOM_ATTRIBUTES.PLAYER_PLACEMENT);if(s&&(n=Number(s)),a){i=Number(a);break}r=r.parentNode}i&&e.selectPlayer(i,n)}},!1),this.element.addEventListener("mouseout",function(t){if(e.settings.hovering!==!1&&!e.showingDetails){for(var r=t.relatedTarget;r&&r!==document&&r!==e.element;)r=r.parentNode;r!==e.element&&e.selectPlayer(-1)}},!1)}}]),e}();r["default"]=T,T.DEFAULT_SETTINGS=o.DEFAULT_SETTINGS,t.exports=r["default"]},{"./parser":3,"./raw2table":4,"./settings":5,"./utils":6}],3:[function(e,t,r){"use strict";function n(e,t){e.setAttribute(o.DOM_ATTRIBUTES.PLAYER_PLACEMENT,t)}function i(e,t){function r(e,t){"string"==typeof i.roundsColumns&&(t=i.roundsColumns.split(",").map(function(e){return t[Number(e)]})),t.forEach(function(t){var r=void 0,n=void 0;if(t.hasAttribute(o.DOM_ATTRIBUTES.GAME_RESULT)&&t.hasAttribute(o.DOM_ATTRIBUTES.OPPONENT_PLACEMENT))r=Number(t.getAttribute(o.DOM_ATTRIBUTES.OPPONENT_PLACEMENT)),n=t.getAttribute(o.DOM_ATTRIBUTES.GAME_RESULT);else{for(var i=0;u>i;i++){var s=t.textContent.match(l[i].regexp);s&&(r=Number(s[1]),n=l[i].cls,t.setAttribute(o.DOM_ATTRIBUTES.OPPONENT_PLACEMENT,r),t.setAttribute(o.DOM_ATTRIBUTES.GAME_RESULT,l[i].cls))}if(!r)return}e.games[r]={cell:t,cls:n},e.opponents.push(r)})}var i=(0,s.defaults)(o.DEFAULT_SETTINGS,t),a=(0,s.asArray)(e.querySelectorAll(i.rowTags)),l=(0,o.toResultsWithRegExp)(i.results),u=l.length,c={},f=void 0,T=void 0;return a.forEach(function(e,t){if(!(t<i.startingRow)){var a=(0,s.asArray)(e.querySelectorAll(i.cellTags)),l=-1;if(!a.length||!a[i.placeColumn])return void n(e,l);var u=parseInt(a[i.placeColumn].textContent,10),E={tournamentPlace:-1,row:e,games:{},opponents:[]};if(e.hasAttribute(o.DOM_ATTRIBUTES.PLAYER_PLACEMENT))l=Number(e.getAttribute(o.DOM_ATTRIBUTES.PLAYER_PLACEMENT));else{if(T)l=T+1;else{if(isNaN(u))return void n(e,l);l=u||1}u?f>=u&&(u=f):u=f?f:1,n(e,l)}-1!=l&&(r(E,a),E.tournamentPlace=u,E.opponents.sort(function(e,t){return e>t?1:-1}),c[l]=E,f=u,T=l)}}),c}Object.defineProperty(r,"__esModule",{value:!0}),r["default"]=i;var s=e("./utils"),o=e("./settings");t.exports=r["default"]},{"./settings":5,"./utils":6}],4:[function(e,t,r){"use strict";function n(e,t){var r=document.createElement("table");if(!e)return r;var n=(0,s.defaults)(i.DEFAULT_SETTINGS,t),o=e.split(/\r\n|\n/);if(o.length<=2&&!o[0]&&!o[1])return r;var a=(0,i.toResultsWithRegExp)(n.results),l=a.length,u=o.map(function(e){return e.replace(/([0-9]+)\s(dan|kyu)/i,"$1_$2").split(new RegExp(n.rowSeparator)).filter(function(e){return e.length>0})}).filter(function(e){return e.length>0&&0!==e[0].indexOf(";")}),c=u.reduce(function(e,t){return Math.max(e,t.length)},0),f=n.joinNames?-1:0,T=n.placeColumn+1,E=null;"string"==typeof n.roundsColumns&&(E=n.roundsColumns.split(",").map(Number));var g=void 0;return u.forEach(function(e,t){var s=document.createElement("tr"),o=e.length;if(o){if(t<n.startingRow||c+f>o){var u=document.createElement("td");u.setAttribute("colspan",c+f),u.textContent=e.join(" "),s.setAttribute(i.DOM_ATTRIBUTES.PLAYER_PLACEMENT,-1),s.appendChild(u)}else{var h=parseInt(e[n.placeColumn],10);isNaN(h)&&!g?e.forEach(function(e){var t=document.createElement("td");t.textContent=e,s.setAttribute(i.DOM_ATTRIBUTES.PLAYER_PLACEMENT,-1),s.appendChild(t)}):!function(){s.setAttribute(i.DOM_ATTRIBUTES.PLAYER_PLACEMENT,g||h);var t=[];n.joinNames&&e.splice(T,2,e[T]+"  "+e[T+1]),e.forEach(function(e,r){var n=document.createElement("td");if(n.textContent=e.replace(/_/," "),!E||E.indexOf(r)>=0)for(var o=0;l>o;o++){var u=e.match(a[o].regexp);if(u){var c=u[1];t.push(c),n.setAttribute(i.DOM_ATTRIBUTES.OPPONENT_PLACEMENT,c),n.setAttribute(i.DOM_ATTRIBUTES.GAME_RESULT,a[o].cls)}}s.appendChild(n)}),t.length&&s.setAttribute(i.DOM_ATTRIBUTES.OPPONENTS,t.join(",")),g?g+=1:g=2}()}r.appendChild(s)}}),r.setAttribute(i.DOM_ATTRIBUTES.RESULT_TABLE,""),r}Object.defineProperty(r,"__esModule",{value:!0}),r["default"]=n;var i=e("./settings"),s=e("./utils");t.exports=r["default"]},{"./settings":5,"./utils":6}],5:[function(e,t,r){"use strict";function n(e){var t=[];for(var r in e)e.hasOwnProperty(r)&&t.push({cls:r,regexp:new RegExp(e[r])});return t}function i(e){var t={};return e.hasAttribute(o.SETTING_PLACE_COLUMN)&&(t.placeColumn=Number(e.getAttribute(o.SETTING_PLACE_COLUMN))),e.hasAttribute(o.SETTING_STARTING_ROW)&&(t.startingRow=Number(e.getAttribute(o.SETTING_STARTING_ROW))),e.hasAttribute(o.SETTING_ROUNDS_COLUMNS)&&(t.roundsColumns=e.getAttribute(o.SETTING_ROUNDS_COLUMNS)),e.hasAttribute(o.SETTING_CLICKING)&&(t.clicking="false"!==e.getAttribute(o.SETTING_CLICKING)),e.hasAttribute(o.SETTING_HOVERING)&&(t.hovering="false"!==e.getAttribute(o.SETTING_HOVERING)),t}Object.defineProperty(r,"__esModule",{value:!0}),r.toResultsWithRegExp=n,r.readTableSettingsFromDOM=i;var s={prefixCls:"go-results-",showingDetailsCls:"showing-details",tableCls:"table",gameCls:"game",currentCls:"current",results:{won:"([0-9]+)\\+",lost:"([0-9]+)\\-",jigo:"([0-9]+)=",unresolved:"([0-9]+)\\?"},startingRow:0,placeColumn:0,roundsColumns:null,rowTags:"tr",cellTags:"td,th",rowSeparator:"[	 ]+",joinNames:!0,hovering:!0,clicking:!0};r.DEFAULT_SETTINGS=s;var o={RESULT_TABLE:"data-go-results",SETTING_STARTING_ROW:"data-go-starting-row",SETTING_PLACE_COLUMN:"data-go-place-col",SETTING_ROUNDS_COLUMNS:"data-go-rounds-cols",SETTING_CLICKING:"data-go-clicking",SETTING_HOVERING:"data-go-hovering",PLAYER_PLACEMENT:"data-go-place",OPPONENT_PLACEMENT:"data-go-opponent",OPPONENTS:"data-go-opponents",GAME_RESULT:"data-go-result"};r.DOM_ATTRIBUTES=o},{}],6:[function(e,t,r){"use strict";function n(e){return Array.prototype.slice.call(e)}function i(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;t>n;n++)r[n-1]=arguments[n];var i=r.filter(function(e){return"object"==typeof e}).reverse(),s=i.length,o={};e:for(var a in e){for(var l=0;s>l;l++)if(i[l].hasOwnProperty(a)){o[a]=i[l][a];continue e}o[a]=e[a]}return o}function s(){for(var e={},t=arguments.length,r=Array(t),n=0;t>n;n++)r[n]=arguments[n];return r.forEach(function(t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])}),e}Object.defineProperty(r,"__esModule",{value:!0}),r.asArray=n,r.defaults=i,r.combine=s},{}]},{},[1])(1)});